conv<-1e-6 # Pa to MPa
Psi_g<-rho*g*alt*conv
V=1/(1+((Psi_solo-Psi_g)/P50)^a)
plot(V~Psi_solo,type="l", ylim=c(0,1))
plot(V~I(theta/theta_sat),type="l", ylim=c(0,1))
# Parametros hidraulicos do solo
theta_sat=0.4 #g H20/g solo
Psi_sat=-0.001 #MPa
b=7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta=seq(0.1,theta_sat,len=1000)
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo=Psi_sat*(theta/theta_sat)^(-b)
plot(Psi_solo~I(theta/theta_sat),type="l")
# Parametros hidr�ulicos da plantas
P50=-2 #MPa
a=6 #sem unidade
# Calculo de V (equa��o de Manzoni et al 2013 - Biological constraints on water transport in the soil-plant-atmosphere system)
# se existir altura no modelo o efeito da gravidade no transporte de �gua pode incluido tbm
rho<-997 #kg/m3
g<-9.8#m/s2
alt<-20#m
conv<-1e-6 # Pa to MPa
Psi_g<-rho*g*alt*conv
V=1/(1+((Psi_solo-Psi_g)/P50)^a)
plot(V~Psi_solo,type="l", ylim=c(0,1))
plot(V~I(theta/theta_sat),type="l", ylim=c(0,1))
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
#compare P88 found numerically with the P88 found analytically
P50=-2
a=seq(2,10,by=0.1)
#analytical solution
P88anl=P88fun(P50,a)
P88anl
#numerical solution
P=seq(P50,10*P50,by=-0.01)
P88num<-NULL
for (i in 1:length(a)) {
k=1/(1+(P/P50)^a[i])
P88num[i]=P[which.min(abs(k-0.12))]}
P88num
#plot
plot(P88anl~P88num)
abline(0,1)
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
#compare P88 found numerically with the P88 found analytically
P50=-2
a=seq(2,10,by=0.1)
#analytical solution
P88anl=P88fun(P50,a)
P88anl
#numerical solution
P=seq(P50,10*P50,by=-0.01)
P88num<-NULL
for (i in 1:length(a)) {
k=1/(1+(P/P50)^a[i])
P88num[i]=P[which.min(abs(k-0.12))]}
P88num
#plot
plot(P88anl~P88num)
abline(0,1)
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
#compare P88 found numerically with the P88 found analytically
P50=-2
a=seq(2,10,by=0.1)
#analytical solution
P88anl=P88fun(P50,a)
P88anl
#numerical solution
P=seq(P50,10*P50,by=-0.01)
P88num<-NULL
for (i in 1:length(a)) {
k=1/(1+(P/P50)^a[i])
P88num[i]=P[which.min(abs(k-0.12))]}
P88num
#plot
plot(P88anl~P88num)
abline(0,1)
a=2
P50=seq(-1,-5,len=100)
y=P88fun(P50,a)
plot(y~P50,type="l")
a=4
y2=P88fun(P50,a)
lines(y2~P50,col=2)
a=8
y3=P88fun(P50,a)
lines(y3~P50,col=4)
# Parametros hidraulicos do solo
theta_sat=0.4 #g H20/g solo
Psi_sat=-0.001 #MPa
b=7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta=seq(0.1,theta_sat,len=1000)
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo=Psi_sat*(theta/theta_sat)^(-b)
# Parametros hidr�ulicos da plantas
P50=-2 #MPa
a=4 #sem unidade
# Calculo de V (equa��o de Manzoni et al 2013 - Biological constraints on water transport in the soil-plant-atmosphere system)
# se existir altura no modelo o efeito da gravidade no transporte de �gua pode incluido tbm
rho<-997 #kg/m3
g<-9.8#m/s2
alt<-20#m
conv<-1e-6 # Pa to MPa
Psi_g<-rho*g*alt*conv
V=1/(1+((Psi_solo-Psi_g)/P50)^a)
#tentando calcular o P88
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
a=2
P50=seq(-1,-5,len=100)
y=P88fun(P50,a)
plot(y~P50,type="l")
a=4
P50=seq(-1,-5,len=100)
y=P88fun(P50,a)
plot(y~P50,type="l")
# Parametros hidraulicos do solo
theta_sat=0.4 #g H20/g solo
Psi_sat=-0.001 #MPa
b=7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta=seq(0.1,theta_sat,len=1000)
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo=Psi_sat*(theta/theta_sat)^(-b)
plot(Psi_solo~I(theta/theta_sat),type="l")
# Parametros hidr�ulicos da plantas
P50=-2 #MPa
a=4 #sem unidade
# Calculo de V (equa��o de Manzoni et al 2013 - Biological constraints on water transport in the soil-plant-atmosphere system)
# se existir altura no modelo o efeito da gravidade no transporte de �gua pode incluido tbm
rho<-997 #kg/m3
g<-9.8#m/s2
alt<-20#m
conv<-1e-6 # Pa to MPa
Psi_g<-rho*g*alt*conv
V=1/(1+((Psi_solo-Psi_g)/P50)^a)
plot(V~Psi_solo,type="l", ylim=c(0,1))
plot(V~I(theta/theta_sat),type="l", ylim=c(0,1))
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
print (P88)
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
print()
#Analytical solution to calculate P88 from P50
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
print(P88fun)
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -2
a = 4
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -2
a = 4
P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
}
result_fun <- P88
print(result_fun)
#Analytical solution to calculate P88 from P50
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -4
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -4
a = 6
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -4
a = 2
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -4
a = 8
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -0.56
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -7
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -3.5
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
# Parametros hidraulicos do solo
theta_sat=0.4 #g H20/g solo
Psi_sat=-0.001 #MPa
b=7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta=seq(0.1,theta_sat,len=1000)
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo=Psi_sat*(theta/theta_sat)^(-b)
plot(Psi_solo~I(theta/theta_sat),type="l")
# Parametros hidr�ulicos da plantas
P50=-2 #MPa
a=4 #sem unidade
# Calculo de V (equa��o de Manzoni et al 2013 - Biological constraints on water transport in the soil-plant-atmosphere system)
# se existir altura no modelo o efeito da gravidade no transporte de �gua pode incluido tbm
rho<-997 #kg/m3
g<-9.8#m/s2
alt<-20#m
conv<-1e-6 # Pa to MPa
Psi_g<-rho*g*alt*conv
V=1/(1+((Psi_solo-Psi_g)/P50)^a)
plot(V~Psi_solo,type="l", ylim=c(0,1))
plot(V~I(theta/theta_sat),type="l", ylim=c(0,1))
#Analytical solution to calculate P88 from P50
#Analytical solution to calculate P88 from P50
P50 = -3.5
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
#Analytical solution to calculate P88 from P50
P50 = -2
a = 4
#  P88fun<-function(P50,a) {
P88=7.33^(1/a)*P50
#}
print(P88)
# library to read netcdf files
library(ncdf4)
#library to plot maps with legend easily
library(fields)
# set wd to HadGEM2ES_Soil_Ancil.nc location
# open netcdf
anci <- nc_open("HadGEM2ES_Soil_Ancil.nc")
# coordinates from where you want the data, example some site in amazon
lat <- -1.74
lon <- -51.46
# check variable names, units and file structure
# anci
# field342 - SATURATED SOIL WATER SUCTION
# field332 - VOL SMC AT SATURATION AFTER TIMESTEP
# field1381 - CLAPP-HORNBERGER B COEFFICIENT
# The longitude in the hadgem file is in a weird format
# The greenwich meridian is 0, and then it increases to 360 to the east, see
b <- ncvar_get(anci, varid = "field1381")
image.plot(anci$dim$longitude$vals,
anci$dim$latitude$vals,
b)
# Function to convert the longitute from -180:180 to 0:360
conv_lon<-function(longitude) {
x <- c(seq(181,360,by=0.5),seq(0,180,by=0.5))
y <- seq(-180,180,by=0.5)
return(x[which.min(abs(y - lon))])
}
lon360<-conv_lon(lon)
b <- ncvar_get(anci, varid = "field1381",count = c(1,1),
start= c(which.min(abs(anci$dim$longitude$vals - lon360)),
which.min(abs(anci$dim$latitude$vals - lat))))
b<-c(b)
Psi_sat <- ncvar_get(anci, varid = "field342",count = c(1,1),
start= c(which.min(abs(anci$dim$longitude$vals - lon360)),
which.min(abs(anci$dim$latitude$vals - lat))))
Psi_sat_cm<-c(Psi_sat*100)# transform m to cm
smc_sat <- ncvar_get(anci, varid = "field332",count = c(1,1),
start= c(which.min(abs(anci$dim$longitude$vals - lon360)),
which.min(abs(anci$dim$latitude$vals - lat))))
smc_sat<-c(smc_sat)
# Example using Clapp & Hornberger (1978) equations to convert smc to Psi_soil
smc<-seq(0.1*smc_sat,smc_sat,length.out = 1000)# example smc vector
Psi_soil_cm<-Psi_sat_cm*(smc/smc_sat)^(-b)
Psi_soil<--Psi_soil_cm*98.04*1e-6# convert Psi_soil from cm to MPa
plot(Psi_soil~smc)
# Parametros hidraulicos do solo
theta_sat = 0.4 #g H20/g solo
Psi_sat = -0.001 #MPa
b = 7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta = seq (0.1, theta_sat, len=1000)
# Umidade do solo
W = theta/theta_sat
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo = Psi_sat * W ^ (-b)
plot (Psi_solo~I(W), type="l")
# Calculo condutância solo-raiz expressa com base na área foliar (ksr; mol m-2 leaf s-1):
Ksr = W ^ (2*b + 3)
print(Ksr)
# Calculo potencial hídrico da raíz (Eller et al. 2018)
Psi_raiz = Psi_solo - (E / Ksr)
plot (Psi_raiz~I(W), type="l")
o volum�trico de �gua no solo (i.e. g H20/g solo)
theta = seq (0.1, theta_sat, len=1000)
# Umidade do solo
W = theta/theta_sat
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo = Psi_sat * W ^ (-b)
plot (Psi_solo~I(W), type="l")
# Calculo condutância solo-raiz expressa com base na área foliar (ksr; mol m-2 leaf s-1):
Ksr = W ^ (2*b + 3)
print(Ksr)
# Parametros faltantes para calcular o psi da raiz
# ARRUMAR VALOR
E = 0.00000000005 #transpiration mol m-2 leaf s-1
# Calculo potencial hídrico da raíz (Eller et al. 2018)
Psi_raiz = Psi_solo - (E / Ksr)
plot (Psi_raiz~I(W), type="l")
# Calculo diferença de pressão entre a raiz e a planta
Psi_dif = Psi_raiz - Psi_solo
# Calculo de V (Manzoni et al 2013) com fator de altura
rho <- 997 #kg/m3
g <- 9.8#m/s2
alt <- 20#m
conv <- 1e-6 # Pa to MPa
Psi_g <- rho*g*alt*conv
V = 1 / (1+ ((Psi_solo - Psi_g) / P50)^a)
plot (V~Psi_solo, type="l", ylim=c(0,1))
plot (V~I(W), type="l", ylim=c(0,1))
# Calculo quantidade de água puxada pela planta (W_uso; VER UNIDADE)
# ARRUMAR CÁLCULO
W_uso = Psi_dif * V
plot (W_uso~I(W), type="l", ylim=c(0,1))
print(W_uso)
# Calculo W atualizado (W_update; VER UNIDADE)
W_update = W - W_uso
print(W_update)
# Parametros hidraulicos do solo
theta_sat = 0.4 #g H20/g solo
Psi_sat = -0.001 #MPa
b = 7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta = seq (0.1, theta_sat, len=1000)
# Umidade do solo
W = theta/theta_sat
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo = Psi_sat * W ^ (-b)
plot (Psi_solo~I(W), type="l")
# Calculo condutância solo-raiz expressa com base na área foliar (ksr; mol m-2 leaf s-1):
Ksr = W ^ (2*b + 3)
print(Ksr)
# Parametros faltantes para calcular o psi da raiz
# ARRUMAR VALOR
E = 0.00000000005 #transpiration mol m-2 leaf s-1
# Calculo potencial hídrico da raíz (Eller et al. 2018)
Psi_raiz = Psi_solo - (E / Ksr)
plot (Psi_raiz~I(W), type="l")
# Calculo diferença de pressão entre a raiz e a planta
Psi_dif = Psi_raiz - Psi_solo
# Calculo de V (Manzoni et al 2013) com fator de altura
rho <- 997 #kg/m3
g <- 9.8#m/s2
alt <- 20#m
conv <- 1e-6 # Pa to MPa
Psi_g <- rho*g*alt*conv
V = 1 / (1+ ((Psi_solo - Psi_g) / P50)^a)
plot (V~Psi_solo, type="l", ylim=c(0,1))
plot (V~I(W), type="l", ylim=c(0,1))
# Calculo quantidade de água puxada pela planta (W_uso; VER UNIDADE)
# ARRUMAR CÁLCULO
W_uso = Psi_dif * V
plot (W_uso~I(W), type="l", ylim=c(0,1))
print(W_uso)
# Calculo W atualizado (W_update; VER UNIDADE)
W_update = W - W_uso
print(W_update)
V = 1 / (1+ ((Psi_solo - Psi_g) / P50)^a)
plot (V~Psi_solo, type="l", ylim=c(0,1))
plot (V~I(W), type="l", ylim=c(0,1))
print (V)
print(Ksr)
print (W)
#constants/produced by the model
b=7#unitless
ksr_max=0.0025#mol m-2 s-1 MPa-1
Psat=-0.01#Saturated soil water potential (Mpa)
E=10*0.001#Transpiration - mol m-2 s-1
W=seq(0.01,1,by=0.01)#normalized soil water content
#Pr calculation
k=W^2*b+3# Normalized k - Clapp & Hornberger 1978
ksr=k*ksr_max#mol m-2 s-1 MPa-1
Ps=Psat*W^-b#Soil water potential - Clapp & Hornberger 1978
Pr=Ps-(E/ksr)#Root water potential
#plot
plot(Pr~W, type="l",ylim=c(-15,0),
ylab=expression(Psi~"("*MPa*")"),xlab="Soil water content (Normalized)")
lines(Ps~W,col=2)
legend("topleft",legend=c(expression(Soil~Psi),expression(Root~Psi)),
col=c(2,1),lty=1,bty="n")
Pr-Ps
# Parametros hidraulicos do solo
theta_sat = 0.4 #g H20/g solo
Psi_sat = -0.001 #MPa
b = 7 #sem unidade
# Conteudo volum�trico de �gua no solo (i.e. g H20/g solo)
theta = seq (0.1, theta_sat, len=1000)
# Umidade do solo
W = theta/theta_sat
print (W)
# Calculo potencial hidrico do solo (Psi_solo MPa - equa��o de Clapp & Hornberger 1978 - Empirical Equations for Some Soil Hydraulic Properties)
Psi_solo = Psi_sat * W ^ (-b)
plot (Psi_solo~I(W), type="l")
# Calculo condutância solo-raiz expressa com base na área foliar (ksr; mol m-2 leaf s-1):
Ksr = W ^ (2*b + 3)
print(Ksr)
#constants/produced by the model
b=7#unitless
ksr_max=0.0025#mol m-2 s-1 MPa-1
Psat=-0.01#Saturated soil water potential (Mpa)
E=10*0.001#Transpiration - mol m-2 s-1
W=seq(0.01,1,by=0.01)#normalized soil water content
#Pr calculation
k=W^2*b+3# Normalized k - Clapp & Hornberger 1978
ksr=k*ksr_max#mol m-2 s-1 MPa-1
print(ksr)
#constants/produced by the model
b=7#unitless
ksr_max=0.0025#mol m-2 s-1 MPa-1
Psat=-0.001#Saturated soil water potential (Mpa)
E=10*0.001#Transpiration - mol m-2 s-1
W=seq(0.01,1,by=0.01)#normalized soil water content
#Pr calculation
k=W^2*b+3# Normalized k - Clapp & Hornberger 1978
ksr=k*ksr_max#mol m-2 s-1 MPa-1
print(ksr)
Ps=Psat*W^-b#Soil water potential - Clapp & Hornberger 1978
Pr=Ps-(E/ksr)#Root water potential
#plot
plot(Pr~W, type="l",ylim=c(-15,0),
ylab=expression(Psi~"("*MPa*")"),xlab="Soil water content (Normalized)")
lines(Ps~W,col=2)
legend("topleft",legend=c(expression(Soil~Psi),expression(Root~Psi)),
col=c(2,1),lty=1,bty="n")
Pr-Ps
#constants/produced by the model
b=7#unitless
ksr_max=0.0025#mol m-2 s-1 MPa-1
Psat=-0.01#Saturated soil water potential (Mpa)
E=10*0.001#Transpiration - mol m-2 s-1
W=seq(0.01,1,by=0.01)#normalized soil water content
#Pr calculation
k=W^2*b+3# Normalized k - Clapp & Hornberger 1978
ksr=k*ksr_max#mol m-2 s-1 MPa-1
print(ksr)
Ps=Psat*W^-b#Soil water potential - Clapp & Hornberger 1978
Pr=Ps-(E/ksr)#Root water potential
#plot
plot(Pr~W, type="l",ylim=c(-15,0),
ylab=expression(Psi~"("*MPa*")"),xlab="Soil water content (Normalized)")
lines(Ps~W,col=2)
legend("topleft",legend=c(expression(Soil~Psi),expression(Root~Psi)),
col=c(2,1),lty=1,bty="n")
Pr-Ps
#constants/produced by the model
b=7#unitless
ksr_max=0.0025#mol m-2 s-1 MPa-1
Psat=-0.01#Saturated soil water potential (Mpa)
E=10*0.001#Transpiration - mol m-2 s-1
W=seq(0.01,1,by=0.01)#normalized soil water content
#Pr calculation
k=W^2*b+3# Normalized k - Clapp & Hornberger 1978
print(k)
ksr=k*ksr_max#mol m-2 s-1 MPa-1
print(ksr)
